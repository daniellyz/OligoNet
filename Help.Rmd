### Help

Recent technical advances in high-resolution mass spectrometry (MS) have made metabolomics experiments commonplace for a wide variety of disciplines. In most studies, a database search is performed to translate mass signals into concrete metabolites, and to further interpret the data in a biological and genomic context. However, this annotation approach is limited by the size of database, therefore many detected mass signals are classified as unknowns without being further considered. OligoNet implements an alternative method to annotate metabolomics data based on the assumption that some higher-molecular-weight "unknowns" are combinations of repeated subunits (residues). The current version of the web server is dedicated to provide putative annotations of peptides in full scan direct infusion MS or LC/GC-MS data. For this purpose, OligoNet attempts to decompose each mass input into a combination(s) of [17 proteinogenic amino acids](https://github.com/daniellyz/OligoNet/blob/master/amino-acid-full.txt). It either uses a recursive algorithm or requests the third-party web server [DECOMP](https://bibiserv2.cebitec.uni-bielefeld.de/decomp). OligoNet provides  user-friendly ouputs for metabolomic experiments, including the display of decomposition results on the web interface, parallel KEGG database annotation, visualization of annotated peptides in KEGG metabolic network and recording results in a excel table.OligoNet provides an additional network-based visualization of decomposition results named "Peptide degradation network" (PDN). Inspired from the previously-published [Kendrick analogous mass difference network](https://www.ncbi.nlm.nih.gov/pubmed/22006638), the ab initio PDN infers all potential hydrolysis reactions (edges) between peptides (nodes). For instance, the mass signal that is decomposed into two alanines and two prolines (abbreviated as A2P2) is connected to "A2" in the network since A2 can be produced in a biological system by the hydrolysis of A2P2.
### Notice
OligoNet is primary developed for processing mass spectrometry data that are already annotated to elemental formula (theoritical masses)  or measured from ultra-high-resolution mass spectrometer with high mass accuracy. 

### Step A: Upload metabolomics data
* File 1 is the mass spectrum data in .txt or .dat format. The data file must organized as it is shown in table 1 with first row as headers. The columns must be separated by tabulations. The decimal mark must be a comma.

![Table 1.](https://raw.githubusercontent.com/daniellyz/OligoNet/master/Tab1.JPG)

^1 The second column must be a list of neutral masses.We suggest that all mass values have the same number of digits after the decimal. 
^2 In further stage of the software, we will calculate the correlation coefficient between metabolic features. It is suggested to have at least P>10 samples for a reliable correlation calculation.
* File 2 (.txt, columns separated by tabulation) contains all additional information of each mass, such as retention time, statistical scores ... These informations could be later displayed on the network. The first column of the file must be IDs of masses. This column must be identical (same ids, in the same order) as in File 1. 
We provide two examples for testing:

Ex-1: Ultrahigh-resolution yeast metabolic profiling data obtained from positive mode FT-ICR-MS: [File 1](https://raw.githubusercontent.com/daniellyz/OligoNet/master/Datasets/Yeast-FT-Pos_additional.txt), [File 2](https://raw.githubusercontent.com/daniellyz/OligoNet/master/Datasets/Yeast-FT-Pos_additional.txt)

Ex-2: Lower resolution yeast metabolic profiling data obtained from positive mode UPLC-MS: [File 1](https://raw.githubusercontent.com/daniellyz/OligoNet/master/Datasets/Yeast-LC-Pos.txt), [File 2](https://github.com/daniellyz/OligoNet/blob/master/Datasets/Yeast-LC-Pos-additional.txt)

### Step B: Perform decomposition
In this step, the Web server attempts to decompose each mass signal to a combinations of subunits. By default, the web server uses the 17 proteinogenic amino acids as subunits for decomposition. Users could modify the subunits by uploading the File 3. The data file must organized as it is shown in table 2 without headers.The decimal mark must be a comma.

![Table 2.](https://raw.githubusercontent.com/daniellyz/OligoNet/master/Tab2.JPG)

^3 The first mass must correspond to the mass loss during condensation of two subunits. For instance, to form a dipeptides from two amino acids, the mass loss is a water. In current version you could only define one type of condensation reaction.
^4 The names of subunits are in the first column and must not contain numbers.
You need to specify the type of input masses, either theoritical masses or experimental masses with a certain tolerance window (up to 0.5 Dalton). As mentioned above, mass decomposition can be performed in two ways on OligoNet: i) using a recursive function written entirely in R ([Change-making problem](http://algorithms.tutorialhorizon.com/dynamic-programming-coin-change-problem/)); ii) by automatically requesting the web server [DECOMP](https://bibiserv2.cebitec.uni-bielefeld.de/decomp). The second solution is recommended for being much more efficient and more reliable. The checkbox "Use DECOMP server" needs to be ticked if users decide to use the third party server. Alternatively, users could perform the mass decomposition manually on [DECOMP](https://bibiserv2.cebitec.uni-bielefeld.de/decomp). During the data submission, the checkboxes "chemically plausible decompositions" and "actual mass for each decomposition" must be disabled and "deviation from query mass for each decomposition" must be enabled. OligoNet could use the Bielefeld server id (e.g. bibiserv2_2016-12-05_161538_XtQxM) for further analysis. When the decomposition is finished, a success message will appear in the tab-panel "Job Status" and users could download the decomposition results. Three columns "Peptides", "NBP", "KEGG" will be added to the end of the original dataset, representing all possible amino acid combinations, number of amino acid combinations and compound code annotated by KEGG database, respectively. Here are the decomposition results of [Ex-1]() and [Ex-2]().

### Step C: Network construction

A peptide degradation network is constructed using UAAC mass signals (mass values that were annotated as a Unique Amino Acid Combination in Step B). The PDN is a hypothetical metabolic network that collects all potential hydrolysis reactions between annotated peptides. Users could choose to omit monomers (here free amino acids) from the network since these high degree vertices could remarkably increase the network complexity (the checkbox "Remove free amino acids").Based on the Spearman correlation coefficient (between -1 and 1), it is possible to keep only the edges that connect two highly correlated vertices (checkbox "Correlation between nodes bigger than").In fact, a high correlation indicates a strong biochemical dependence between coexisting peptides. An interactive network visualization is displayed in the tabpanel "Entire PDN" if the checkbox "Show entire network" is ticked. Users could zoom in/out and drag in order to displace the nodes. They could also specify the information displayed (according to the column names from File 2) when the mouse touches the nodes. The network matrix contains three columns describing all edges in the network: source node id, target node id and transformation (amino acid difference between connected nodes). It can be download as a .txt file and be exported to softwares such as Cytoscape for further analysis. Here are the network files of [Ex-1]() and [Ex-2]().

### Display of decomposition results

The tabpanel UAAC-annotation displays mass values that were annotated as a Unique Amino Acid Combination. The tabpanel MAAP-annotationc displays mass values that were annotated as MultiPle Amino Acid combinations. 

### Network visualization and analysis

Apart from the visualization of the entire PDN, OligoNet propose several graph analysis of the PDN. It could also extract some interesting subgraphs from the network. Users could enter the tabpanels "PDN analysis" and "Subgraphs" for further explanation. 

### Peptides in metabolic pathways





